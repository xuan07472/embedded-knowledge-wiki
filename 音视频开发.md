# 音视频（多媒体）开发  

* H.264  
单独的h264文件，由很多个NALU组成，具体的格式是Annex B + NALU，每个NALU开头包含一个起始码（0x00 0x00 0x00 0x01，或者0x00 0x00 0x01），文件中其它任何地方的0x00 0x00 0x00 0x01都会被替换为别的数据串，所以该起始码不会有冲突（mp4封装中使用avcC + NALU，将起始码替换成了长度）。  

一个NALU不标示出长度，需要通过判断两个NALU的间隔来计算出前一个NALU的长度。  

通常可认为一个NALU就是一帧图形，但是也有时多个NALU才是一帧图形，需要解析NALU中地址为0的宏块才能具体得知那个NALU是一帧图片的起始。  

[H264数据格式解析](https://blog.csdn.net/qq_34613314/article/details/117430731)  
[H264的两种格式](https://blog.csdn.net/qq_37837061/article/details/116789262)  
[h264 nal表示一个完整帧吗](https://zhidao.baidu.com/question/715104681053251845.html)  
[H264裸码流I/P/B帧类型判别](https://www.cnblogs.com/Dreaming-in-Gottingen/p/13799066.html)  
[如何把H264文件的数据一帧一帧的读出来?(先不用考虑解码)](https://bbs.csdn.net/topics/310188224)  

* h264编码成mp4  
1、需用从h264码流的第一帧中的前几个NALU中获取PPS、SPS、VPS(h265)信息并将其保存到mp4的一个box中（stbl-stsd-avc1-avcC）。  
2、需要分析每一个NALU，确定一帧数据包含的NALU数量。  
3、将Annex B + NALU的起始码格式转换avcC + NALU的格式，每一份avcC数据存放一帧图片的数据。  

[自己动手写 H.264 解码器---AnnexB 和 avcC](https://juejin.cn/post/6921906696256225293)  

* YUV444一个像素3字节，YUV422一个像素2字节，YUV420（NV12）一个像素1.5字节
[像素数据YUV简介与觉存储格式介绍](https://www.bbsmax.com/A/WpdK4XwnzV/)  