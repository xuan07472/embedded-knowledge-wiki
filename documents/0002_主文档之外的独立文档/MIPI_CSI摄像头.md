# MIPI CSI OV5640摄像头驱动调试  

*参考网址：*  
[MIPI CSI-2 协议解析](https://blog.csdn.net/sinat_43629962/article/details/123089993)  
[csi mipi信号解析](https://blog.csdn.net/adazone/article/details/116459602)  
[mipi-csi-2解读](https://www.cnblogs.com/lidan2019/p/10421875.html)  
[CMOS Image Sensor的MIPI CSI接口介绍及波形实测](https://zhuanlan.zhihu.com/p/143432645)  
[MIPI CSI-2 协议解析](https://blog.csdn.net/sinat_43629962/article/details/123089993)  
[MIPI CSIDSI 简介及信号和协议测试方法](https://wenku.baidu.com/view/9883d9f1cd2f0066f5335a8102d276a2002960fa.html)  
[MIPI CSI-2总结: 基于DPHY2.1](https://blog.csdn.net/yangchao315/article/details/123552464)  

有两种模式，低速（10M内）和高速（80M~1G）  
传输单元为字节，大小端可配置  
时钟有连续模式和非连续模式  
虽然是差分信号，但是在1.2V和0V的位置电平是类似的，只在0mv~300mv之间的信号才是差分的。  
CCI控制接口兼容I2C标准。  
mipi csi图像数据传输的接口，一对差分信号数据传输是单向的，接收端只能进行侦测，而不能在该信号线上进行控制和响应（要通过别的方式控制）。  

* 如果摄像头没有数据，则先用示波器量CLK_N、CLK_P这对时钟差分信号：电平范围应该在0 ~ 1.2V之内，而高速信号时时钟为200mV+-100mv，80 ~ 1000MHz；低速时钟高低电平就是1.2V和0V。注意测量时不要把示波器探头打到10x，要不然信号放大10倍后杂波可能就有+-100mv的波动，会让人误以为是时钟信号。  
* 因为mipi csi是高速信号，所以示波器是量不出方波的（能量出帧同步等1.2V信号），甚至在时钟线上量出来是一个直线（量不出时钟200mv幅度的变化），所以最好使用协议分析仪来分析。  
* ov5640 0x4800寄存器可以配置时钟模式，一种是空闲时低电平，只在有图像时才激活时钟信号；一种是时钟有时钟信号，没调出画面前可以先让时钟一直有，然后让主控芯片里面的mipi csi驱动进入自测模式，确认时钟输入没有问题。  
* 如果要让ov5640 dvp或者mipi摄像头显示图像，需要一次性配置250个左右的寄存器，自己熟悉每个寄存器是不现实的，一般从官方文档中获取到配置demo后先跑一次进行尝试，如果成功了那万幸，如果不成功那就根据demo中的参数一个个确定寄存器，先调出时钟，再调出数据。  

* mipi csi摄像头测试时如果两端图像格式设置的不一样（RGB/YUV等格式），那么则始终不会有画面显示，连乱码都不会显示，所以两边格式一定要匹配好。  
