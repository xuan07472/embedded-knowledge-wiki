# JPEG、PNG、BMP图片格式描述

|作者|将狼才鲸|
|---|---|
|创建日期|2022-11-01|

---

## 一、JPEG、PNG、BMP图片格式简述

* BMP是图片原图，类似于视频中的YUV，YCrCb，每一个像素的三原色都原样的存储下来，所以能直接显示，不用解码。
* JPEG和PNG是经过压缩编码的图片，显示时需要先解码；PNG支持透明的像素，JPEG不支持；PNG是无损压缩，JPEG是有损压缩。
* 有些简单的解码器解码图片时需要从图片文件里获取一定的信息，然后一起送去图片解码器解码；也就说要先用代码解析图片文件，获取到一定的图片配置信息，然后才能解码显示。这和视频解码类似，视频解码时要用软件先对MP4、MKV等容器解封装，然后将里面的内容分成视频流和音频流，然后分别送到视频解码器和音频解码器分别解码，解码完之后再控制好音视频同步，一起显示播放。
* 简单图片解码器需要解析图片文件并获取的参数有：
1. JPEG：图像宽高，解码模式444、422、411，霍夫曼表Y/Cr/Cb AC/DC，量化表系数QT0-2，码流。
2. PNG：图像宽高，像素位深度，颜色类型，压缩式LZ77窗口大小，码流，distance 霍夫曼表，PLAT表，IDAT。

## 一、 JPEG概述
* JPEG图片格式组成部分：SOI（文件头）+APP0（图像识别信息）+ DQT（定义量化表）+ SOF0（图像基本信息）+ DHT（定义Huffman表） + DRI（定义重新开始间隔）+ SOS（扫描行开始）+ EOI（文件尾）。
* JPEG文件中的内容是一段一段存储的。
* 段的结构：

|名称|字节数|数据|说明|
|---|---|---|---|
|段标识|1|FF|每个新段的开始标识|
|段类型|1||类型编码（称作“标记码”）|
|段长度|2||包括段内容和段长度本身,不包括段标识和段类型|
|段内容| ≤65533字节|||

* 段的种类：

|名称|标记码|说明|里面的内容|
|---|---|---|---|
|SOI|D8|文件头|无|
|EOI|D9|文件尾|无|
|SOF0|C0|帧开始（标准 JPEG）|组件数量3 YCrCb、位深度、图片宽高、量化表号|
|SOF1|C1|同上|
|DHT|C4|定义 Huffman 表（霍夫曼表）|表号、AC还是DC|
|SOS|DA|扫描行开始|行内组件数、Y/Cb/Cr/AC/DC选择|
|DQT|DB|定义量化表|0~3QT号、QT精度8/16bit、QT长度、量化表数据|
|DRI|DD|定义重新开始间隔|
|APP0|E0|定义交换格式和图像识别信息|宽、高、像素密度|
|COM FE|注释||


* *参考网址：*  
  [jpeg图片格式详解](https://blog.csdn.net/zz460833359/article/details/123921851)  
  [JPEG文件格式分析及举例验证](https://blog.csdn.net/weixin_49319373/article/details/123782858)

## 二、PNG概述

* 使用从LZ77派生的无损数据压缩算法，支持透明像素，无损压缩。
* PNG图像格式文件由一个8字节的PNG文件署名域和按照特定结构组织的3个以上的数据块组成。
* 文件头：十六进制数 89 50 4e 47 0d 0a 1a 0a。
* PNG像素位深度有8、24、32位的，只有32位支持透明像素，每个像素多了一个8位的透明度。
* 数据块的结构：

|数据块结构：|长度|类型码|块数据|CRC|
|---|---|---|---|---|
||||||

* 数据块的种类：

|数据库名称|内容描述|
|---|---|
|文件头IHDR|图像宽高、位深度、颜色类型、压缩方法、滤波器、隔行扫描|
|调色板PLTE||
|图像数据IDAT|实际图像数据|
|文件尾IEND||


* *参考网址：*
  [作业3.1png图像格式文件解析](https://blog.csdn.net/m0_53538517/article/details/115084747)
  [PNG文件格式分析](https://blog.csdn.net/m0_58972462/article/details/123572070)

## 三 BMP概述

* *参考网址：*
* [BMP文件格式详解（BMP file format）](https://blog.csdn.net/qq_41137110/article/details/119893817)
* [BMP文件格式解析](https://blog.csdn.net/XYK0318/article/details/105123197)
### BMP生成默认颜色的图片、打印BMP图片信息、比较两个BMP文件并保存差异信息的C语言源码
[Gitee源码地址](https://gitee.com/langcai1943/bmp_modify_display)
